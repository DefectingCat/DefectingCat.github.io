<!DOCTYPE html><html lang="zh-CN" data-default-color-scheme="&#34;auto&#34;"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/images/img/apple-touch-icon.webp"><link rel="icon" type="image/png" href="/images/img/favicon.webp"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="theme-color" content="#9DC8C8"><meta name="description" content=""><meta name="author" content="Defectink"><meta name="keywords" content=""><title>Headerå®è·µ-å¾—æ‹¿ä¸‹è¿™ä¸ªA - ğŸ­Defectink</title><link rel="stylesheet" href="https://cdn.defectink.com/static/twitter-bootstrap/4.5.3/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.defectink.com/static/github-markdown-css/4.0.0/github-markdown.min.css"><link rel="stylesheet" href="/lib/hint/hint.min.css"><link rel="stylesheet" href="https://cdn.defectink.com/static/highlight.js/10.0.0/styles/github-gist.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css"><link rel="stylesheet" href="https://cdn.defectink.com/static/t/font_1736178_kmeydafke9r.css"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/css/xfy.css"><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/xml/atom.xml" title="ğŸ­Defectink" type="application/atom+xml"><link rel="alternate" href="/xml/rss.xml" title="ğŸ­Defectink" type="application/rss+xml"></head><body><header style="height:75vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/">&nbsp;<strong>ğŸ­Defectink</strong>&nbsp;</a> <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/">ğŸ  é¦–é¡µ</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">ğŸ“• ç´¢å¼•</a><div class="dropdown-menu" aria-labelledby="navbarDropdown"><a class="dropdown-item" href="/categories/">ğŸ åˆ†ç±»</a> <a class="dropdown-item" href="/tags/">ğŸ æ ‡ç­¾</a></div></li><li class="nav-item"><a class="nav-link" href="/archives/">ğŸ“‚ å½’æ¡£</a></li><li class="nav-item"><a class="nav-link" href="/about/">ğŸƒ å…³äº</a></li><li class="nav-item"><a class="nav-link" href="/links/">ğŸ™†â€â™€ï¸ å°ä¼™ä¼´</a></li><li class="nav-item"><a class="nav-link" href="/pgp/">ğŸ” PGP</a></li><li class="nav-item" id="search-btn"><a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;<i class="iconfont icon-search"></i>&nbsp;</a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" href="javascript:">&nbsp;<i class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a></li></ul></div></div></nav><div class="banner intro-2" id="background" parallax="true" style="background:url(/images/img/post.webp) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="container page-header text-center fade-in-up"><span class="h2" id="subtitle"></span><div class="mt-3"><span class="post-meta mr-2"><i class="iconfont icon-author" aria-hidden="true"></i> Defectink</span><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2019-12-18 16:42" pubdate>2019å¹´12æœˆ18æ—¥ ä¸‹åˆ</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 2.3k å­—</span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 27 åˆ†é’Ÿ</span></div></div></div></div></div></header><main><div class="container-fluid"><div class="row"><div class="d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-md"><div class="container nopadding-md" id="board-ctn"><div class="py-5" id="board"><article class="post-content mx-auto" id="post"><h1 style="display:none">Headerå®è·µ-å¾—æ‹¿ä¸‹è¿™ä¸ªA</h1><p class="note note-info">æœ¬æ–‡æœ€åæ°´äºï¼š2020å¹´11æœˆ2æ—¥ å‡Œæ™¨</p><div class="markdown-body" id="post-body"><p><a target="_blank" rel="noopener" href="https://securityheaders.com/">Headerå®‰å…¨æ£€æµ‹</a></p><p>ä¹‹å‰åœ¨å­¦ä¹ HTMLæ—¶å€™ç ”ç©¶è¿‡<code>X-Frame-Options</code>ï¼Œå®ƒä¹Ÿæ˜¯headerå¤´ä¸­çš„ä¸€ä¸ªå®‰å…¨ç­–ç•¥ã€‚ç”¨äºç»™æµè§ˆå™¨æŒ‡ç¤ºæ˜¯å¦å…è®¸ä¸€ä¸ªé¡µé¢èƒ½å¦åµŒå…¥<code>&lt;iframe&gt;</code>ç­‰åµŒå…¥å…ƒç´ ã€‚</p><p>ä¸‹è¿°æ‰€æœ‰apache2çš„æ“ä½œéƒ½éœ€è¦å…ˆå¯ç”¨<code>header</code>æ¨¡å—ï¼ˆModelï¼‰æ‰èƒ½ä½¿ç”¨ã€‚</p><p>æ‰€æœ‰å‚è€ƒ/æ‘˜å½•æ¥è‡ªäº<a target="_blank" rel="noopener" href="https://developer.mozilla.org/">MDN</a></p><h2 id="X-Frame-Options"><a href="#X-Frame-Options" class="headerlink" title="X-Frame-Options"></a>X-Frame-Options</h2><p><a href="https://www.defectink.com/defect/HTML-practice-x-frame-option.html">https://www.defectink.com/defect/HTML-practice-x-frame-option.html</a></p><h2 id="Strict-Transport-Security"><a href="#Strict-Transport-Security" class="headerlink" title="Strict-Transport-Security"></a>Strict-Transport-Security</h2><p><code>HTTP Strict Transport Security</code>ï¼ˆé€šå¸¸ç®€ç§°ä¸ºHSTSï¼‰æ˜¯ä¸€ä¸ªå®‰å…¨åŠŸèƒ½ï¼Œå®ƒå‘Šè¯‰æµè§ˆå™¨åªèƒ½é€šè¿‡HTTPSè®¿é—®å½“å‰èµ„æºï¼Œè€Œä¸æ˜¯HTTPã€‚</p><p>ä¸€ä¸ªç½‘ç«™æ¥å—ä¸€ä¸ªHTTPçš„è¯·æ±‚ï¼Œç„¶åè·³è½¬åˆ°HTTPSï¼Œç”¨æˆ·å¯èƒ½åœ¨å¼€å§‹è·³è½¬å‰ï¼Œé€šè¿‡æ²¡æœ‰åŠ å¯†çš„æ–¹å¼å’ŒæœåŠ¡å™¨å¯¹è¯ï¼Œæ¯”å¦‚ï¼Œç”¨æˆ·è¾“å…¥<a target="_blank" rel="noopener" href="http://foo.comæˆ–è€…ç›´æ¥foo.com./">http://foo.comæˆ–è€…ç›´æ¥foo.comã€‚</a></p><p>è¿™æ ·å­˜åœ¨ä¸­é—´äººæ”»å‡»æ½œåœ¨å¨èƒï¼Œè·³è½¬è¿‡ç¨‹å¯èƒ½è¢«æ¶æ„ç½‘ç«™åˆ©ç”¨æ¥ç›´æ¥æ¥è§¦ç”¨æˆ·ä¿¡æ¯ï¼Œè€Œä¸æ˜¯åŸæ¥çš„åŠ å¯†ä¿¡æ¯ã€‚</p><p>ç½‘ç«™é€šè¿‡HTTP Strict Transport Securityé€šçŸ¥æµè§ˆå™¨ï¼Œè¿™ä¸ªç½‘ç«™ç¦æ­¢ä½¿ç”¨HTTPæ–¹å¼åŠ è½½ï¼Œæµè§ˆå™¨åº”è¯¥è‡ªåŠ¨æŠŠæ‰€æœ‰å°è¯•ä½¿ç”¨HTTPçš„è¯·æ±‚è‡ªåŠ¨æ›¿æ¢ä¸ºHTTPSè¯·æ±‚ã€‚</p><h3 id="Apacheé…ç½®"><a href="#Apacheé…ç½®" class="headerlink" title="Apacheé…ç½®"></a>Apacheé…ç½®</h3><p>åœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ï¼š</p><pre><code class="hljs pgsql"><span class="hljs-keyword">Header</span> <span class="hljs-keyword">always</span> <span class="hljs-keyword">set</span> <span class="hljs-keyword">Strict</span>-Transport-<span class="hljs-keyword">Security</span> &quot;max-age=63072000; includeSubdomains;&quot;</code></pre><h3 id="æµè§ˆå™¨å·¥ä½œæ–¹å¼"><a href="#æµè§ˆå™¨å·¥ä½œæ–¹å¼" class="headerlink" title="æµè§ˆå™¨å·¥ä½œæ–¹å¼"></a>æµè§ˆå™¨å·¥ä½œæ–¹å¼</h3><p>ä½ çš„ç½‘ç«™ç¬¬ä¸€æ¬¡é€šè¿‡HTTPSè¯·æ±‚ï¼ŒæœåŠ¡å™¨å“åº”<code>Strict-Transport-Security</code> å¤´ï¼Œæµè§ˆå™¨è®°å½•ä¸‹è¿™äº›ä¿¡æ¯ï¼Œç„¶ååé¢å°è¯•è®¿é—®è¿™ä¸ªç½‘ç«™çš„è¯·æ±‚éƒ½ä¼šè‡ªåŠ¨æŠŠHTTPæ›¿æ¢ä¸ºHTTPSã€‚</p><p>å½“HSTSå¤´è®¾ç½®çš„è¿‡æœŸæ—¶é—´åˆ°äº†ï¼Œåé¢é€šè¿‡HTTPçš„è®¿é—®æ¢å¤åˆ°æ­£å¸¸æ¨¡å¼ï¼Œä¸ä¼šå†è‡ªåŠ¨è·³è½¬åˆ°HTTPSã€‚</p><p>æ¯æ¬¡æµè§ˆå™¨æ¥æ”¶åˆ°Strict-Transport-Securityå¤´ï¼Œå®ƒéƒ½ä¼šæ›´æ–°è¿™ä¸ªç½‘ç«™çš„è¿‡æœŸæ—¶é—´ï¼Œæ‰€ä»¥ç½‘ç«™å¯ä»¥åˆ·æ–°è¿™äº›ä¿¡æ¯ï¼Œé˜²æ­¢è¿‡æœŸå‘ç”Ÿã€‚</p><p>Chromeã€Firefoxç­‰æµè§ˆå™¨é‡Œï¼Œå½“æ‚¨å°è¯•è®¿é—®è¯¥åŸŸåä¸‹çš„å†…å®¹æ—¶ï¼Œä¼šäº§ç”Ÿä¸€ä¸ª307 Internal Redirectï¼ˆå†…éƒ¨è·³è½¬ï¼‰ï¼Œè‡ªåŠ¨è·³è½¬åˆ°HTTPSè¯·æ±‚ã€‚</p><h3 id="è¯­æ³•"><a href="#è¯­æ³•" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h3><pre><code class="hljs pgsql"><span class="hljs-keyword">Strict</span>-Transport-<span class="hljs-keyword">Security</span>: max-age=&lt;expire-<span class="hljs-type">time</span>&gt;
<span class="hljs-keyword">Strict</span>-Transport-<span class="hljs-keyword">Security</span>: max-age=&lt;expire-<span class="hljs-type">time</span>&gt;; includeSubDomains
<span class="hljs-keyword">Strict</span>-Transport-<span class="hljs-keyword">Security</span>: max-age=&lt;expire-<span class="hljs-type">time</span>&gt;; preload</code></pre><ul><li><code>max-age=&lt;expire-time&gt;</code>ï¼šè®¾ç½®åœ¨æµè§ˆå™¨æ”¶åˆ°è¿™ä¸ªè¯·æ±‚åçš„<expire-time>ç§’çš„æ—¶é—´å†…å‡¡æ˜¯è®¿é—®è¿™ä¸ªåŸŸåä¸‹çš„è¯·æ±‚éƒ½ä½¿ç”¨HTTPSè¯·æ±‚ã€‚</expire-time></li><li><code>includeSubDomains</code>ï¼šå¦‚æœè¿™ä¸ªå¯é€‰çš„å‚æ•°è¢«æŒ‡å®šï¼Œé‚£ä¹ˆè¯´æ˜æ­¤è§„åˆ™ä¹Ÿé€‚ç”¨äºè¯¥ç½‘ç«™çš„æ‰€æœ‰å­åŸŸåã€‚</li><li><code>preload</code>ï¼šæŸ¥çœ‹ <a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Security/HTTP_Strict_Transport_Security#%E9%A2%84%E5%8A%A0%E8%BD%BD_HSTS">é¢„åŠ è½½ HSTS</a> è·å¾—è¯¦æƒ…ã€‚ä¸æ˜¯æ ‡å‡†çš„ä¸€éƒ¨åˆ†ã€‚</li></ul><h2 id="Content-Security-Policy"><a href="#Content-Security-Policy" class="headerlink" title="Content-Security-Policy"></a>Content-Security-Policy</h2><p>å†…å®¹å®‰å…¨ç­–ç•¥ (<a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Glossary/CSP">CSP</a>) æ˜¯ä¸€ä¸ªé¢å¤–çš„å®‰å…¨å±‚ï¼Œç”¨äºæ£€æµ‹å¹¶å‰Šå¼±æŸäº›ç‰¹å®šç±»å‹çš„æ”»å‡»ï¼ŒåŒ…æ‹¬è·¨ç«™è„šæœ¬ (<a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Glossary/XSS">XSS</a>) å’Œæ•°æ®æ³¨å…¥æ”»å‡»ç­‰ã€‚æ— è®ºæ˜¯æ•°æ®ç›—å–ã€ç½‘ç«™å†…å®¹æ±¡æŸ“è¿˜æ˜¯æ•£å‘æ¶æ„è½¯ä»¶ï¼Œè¿™äº›æ”»å‡»éƒ½æ˜¯ä¸»è¦çš„æ‰‹æ®µã€‚</p><h3 id="Apacheé…ç½®-1"><a href="#Apacheé…ç½®-1" class="headerlink" title="Apacheé…ç½®"></a>Apacheé…ç½®</h3><p>åœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ï¼š</p><pre><code class="hljs html">Header set Content-Security-Policy &quot;default-src &#x27;self&#x27; https://cdn.defectink.com; script-src &#x27;self&#x27; &#x27;unsafe-inline&#x27; &#x27;unsafe-eval&#x27; https://maxcdn.bootstrapcdn.com https://ajax.googleapis.com https://cdn.defectink.com; img-src *; style-src &#x27;self&#x27; &#x27;unsafe-inline&#x27; https://cdn.defectink.com https://maxcdn.bootstrapcdn.com https://fonts.googleapis.com/; font-src &#x27;self&#x27; https://cdn.defectink.com https://fonts.gstatic.com/ https://maxcdn.bootstrapcdn.com; form-action &#x27;self&#x27; https://cdn.defectink.com; upgrade-insecure-requests;&quot;</code></pre><p>è¯´ç™½äº†å°±æ˜¯æ·»åŠ å…è®¸åŠ è½½çš„è„šæœ¬ã€æ ·å¼ç­‰å†…å®¹çš„ç™½åå•ã€‚é…ç½®ç›¸åº”çš„å€¼ï¼Œä»¥æ§åˆ¶ç”¨æˆ·ä»£ç†ï¼ˆæµè§ˆå™¨ç­‰ï¼‰å¯ä»¥ä¸ºè¯¥é¡µé¢è·å–å“ªäº›èµ„æºã€‚æ¯”å¦‚ä¸€ä¸ªå¯ä»¥ä¸Šä¼ æ–‡ä»¶å’Œæ˜¾ç¤ºå›¾ç‰‡é¡µé¢ï¼Œåº”è¯¥å…è®¸å›¾ç‰‡æ¥è‡ªä»»ä½•åœ°æ–¹ï¼Œä½†é™åˆ¶è¡¨å•çš„actionå±æ€§åªå¯ä»¥èµ‹å€¼ä¸ºæŒ‡å®šçš„ç«¯ç‚¹ã€‚ä¸€ä¸ªç»è¿‡æ°å½“è®¾è®¡çš„å†…å®¹å®‰å…¨ç­–ç•¥åº”è¯¥å¯ä»¥æœ‰æ•ˆçš„ä¿æŠ¤é¡µé¢å…å—è·¨ç«™è„šæœ¬æ”»å‡»ã€‚</p><h3 id="è·¨ç«™è„šæœ¬æ”»å‡»"><a href="#è·¨ç«™è„šæœ¬æ”»å‡»" class="headerlink" title="è·¨ç«™è„šæœ¬æ”»å‡»"></a>è·¨ç«™è„šæœ¬æ”»å‡»</h3><p>CSP çš„ä¸»è¦ç›®æ ‡æ˜¯å‡å°‘å’ŒæŠ¥å‘Š XSS æ”»å‡» ï¼ŒXSS æ”»å‡»åˆ©ç”¨äº†æµè§ˆå™¨å¯¹äºä»æœåŠ¡å™¨æ‰€è·å–çš„å†…å®¹çš„ä¿¡ä»»ã€‚æ¶æ„è„šæœ¬åœ¨å—å®³è€…çš„æµè§ˆå™¨ä¸­å¾—ä»¥è¿è¡Œï¼Œå› ä¸ºæµè§ˆå™¨ä¿¡ä»»å…¶å†…å®¹æ¥æºï¼Œå³ä½¿æœ‰çš„æ—¶å€™è¿™äº›è„šæœ¬å¹¶éæ¥è‡ªäºå®ƒæœ¬è¯¥æ¥çš„åœ°æ–¹ã€‚</p><p>CSPé€šè¿‡æŒ‡å®šæœ‰æ•ˆåŸŸâ€”â€”å³æµè§ˆå™¨è®¤å¯çš„å¯æ‰§è¡Œè„šæœ¬çš„æœ‰æ•ˆæ¥æºâ€”â€”ä½¿æœåŠ¡å™¨ç®¡ç†è€…æœ‰èƒ½åŠ›å‡å°‘æˆ–æ¶ˆé™¤XSSæ”»å‡»æ‰€ä¾èµ–çš„è½½ä½“ã€‚ä¸€ä¸ªCSPå…¼å®¹çš„æµè§ˆå™¨å°†ä¼šä»…æ‰§è¡Œä»ç™½åå•åŸŸè·å–åˆ°çš„è„šæœ¬æ–‡ä»¶ï¼Œå¿½ç•¥æ‰€æœ‰çš„å…¶ä»–è„šæœ¬ (åŒ…æ‹¬å†…è”è„šæœ¬å’ŒHTMLçš„äº‹ä»¶å¤„ç†å±æ€§)ã€‚</p><p>ä½œä¸ºä¸€ç§ç»ˆæé˜²æŠ¤å½¢å¼ï¼Œå§‹ç»ˆä¸å…è®¸æ‰§è¡Œè„šæœ¬çš„ç«™ç‚¹å¯ä»¥é€‰æ‹©å…¨é¢ç¦æ­¢è„šæœ¬æ‰§è¡Œã€‚</p><h3 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h3><p>ä¸€ä¸ªç½‘ç«™ç®¡ç†è€…æƒ³è¦æ‰€æœ‰å†…å®¹å‡æ¥è‡ªç«™ç‚¹çš„åŒä¸€ä¸ªæº (ä¸åŒ…æ‹¬å…¶å­åŸŸå)</p><pre><code class="hljs html">Content-Security-Policy: default-src &#x27;self&#x27;</code></pre><p>ä¸€ä¸ªç½‘ç«™ç®¡ç†è€…å…è®¸ç½‘é¡µåº”ç”¨çš„ç”¨æˆ·åœ¨ä»–ä»¬è‡ªå·±çš„å†…å®¹ä¸­åŒ…å«æ¥è‡ªä»»ä½•æºçš„å›¾ç‰‡, ä½†æ˜¯é™åˆ¶éŸ³é¢‘æˆ–è§†é¢‘éœ€ä»ä¿¡ä»»çš„èµ„æºæä¾›è€…(è·å¾—)ï¼Œæ‰€æœ‰è„šæœ¬å¿…é¡»ä»ç‰¹å®šä¸»æœºæœåŠ¡å™¨è·å–å¯ä¿¡çš„ä»£ç .</p><pre><code class="hljs html">Content-Security-Policy: default-src &#x27;self&#x27;; img-src *; media-src media1.com media2.com; script-src userscripts.example.com</code></pre><p>åœ¨è¿™é‡Œï¼Œå„ç§å†…å®¹é»˜è®¤ä»…å…è®¸ä»æ–‡æ¡£æ‰€åœ¨çš„æºè·å–, ä½†å­˜åœ¨å¦‚ä¸‹ä¾‹å¤–:</p><ul><li>å›¾ç‰‡å¯ä»¥ä»ä»»ä½•åœ°æ–¹åŠ è½½(æ³¨æ„ â€œ*â€ é€šé…ç¬¦)ã€‚</li><li>å¤šåª’ä½“æ–‡ä»¶ä»…å…è®¸ä» media1.com å’Œ media2.com åŠ è½½(ä¸å…è®¸ä»è¿™äº›ç«™ç‚¹çš„å­åŸŸå)ã€‚</li><li>å¯è¿è¡Œè„šæœ¬ä»…å…è®¸æ¥è‡ªäºuserscripts.example.comã€‚</li></ul><h2 id="X-Content-Type-Options"><a href="#X-Content-Type-Options" class="headerlink" title="X-Content-Type-Options"></a>X-Content-Type-Options</h2><p><code>X-Content-Type-Options</code> å“åº”é¦–éƒ¨ç›¸å½“äºä¸€ä¸ªæç¤ºæ ‡å¿—ï¼Œè¢«æœåŠ¡å™¨ç”¨æ¥æç¤ºå®¢æˆ·ç«¯ä¸€å®šè¦éµå¾ªåœ¨ <a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Content-Type"><code>Content-Type</code></a> é¦–éƒ¨ä¸­å¯¹ <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types">MIME ç±»å‹</a> çš„è®¾å®šï¼Œè€Œä¸èƒ½å¯¹å…¶è¿›è¡Œä¿®æ”¹ã€‚</p><p>æ³¨æ„: <code>nosniff</code> åªåº”ç”¨äº â€œ<code>script</code>â€œ å’Œ â€œ<code>style</code>â€œ ä¸¤ç§ç±»å‹ã€‚äº‹å®è¯æ˜ï¼Œå°†å…¶åº”ç”¨äºå›¾ç‰‡ç±»å‹çš„æ–‡ä»¶ä¼šå¯¼è‡´<a target="_blank" rel="noopener" href="https://github.com/whatwg/fetch/issues/395">ä¸ç°æœ‰çš„ç«™ç‚¹å†²çª</a>ã€‚</p><h3 id="Apacheé…ç½®-2"><a href="#Apacheé…ç½®-2" class="headerlink" title="Apacheé…ç½®"></a>Apacheé…ç½®</h3><p>åœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ï¼š</p><pre><code class="hljs pgsql"><span class="hljs-keyword">Header</span> <span class="hljs-keyword">set</span> X-Content-<span class="hljs-keyword">Type</span>-<span class="hljs-keyword">Options</span> nosniff</code></pre><h3 id="è¯­æ³•-1"><a href="#è¯­æ³•-1" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h3><p><code>nosniff</code></p><p>ä¸‹é¢ä¸¤ç§æƒ…å†µçš„è¯·æ±‚å°†è¢«é˜»æ­¢ï¼š</p><ul><li>è¯·æ±‚ç±»å‹æ˜¯â€<code>style</code>â€œ ä½†æ˜¯ MIME ç±»å‹ä¸æ˜¯ â€œ<code>text/css</code>â€œï¼Œ</li><li>è¯·æ±‚ç±»å‹æ˜¯â€<code>script</code>â€œ ä½†æ˜¯ MIME ç±»å‹ä¸æ˜¯ <a target="_blank" rel="noopener" href="https://html.spec.whatwg.org/multipage/scripting.html#javascript-mime-type">JavaScript MIME ç±»å‹</a>ã€‚</li></ul><h2 id="Referrer-Policy"><a href="#Referrer-Policy" class="headerlink" title="Referrer-Policy"></a>Referrer-Policy</h2><p><strong><code>Referrer-Policy</code></strong> é¦–éƒ¨ç”¨æ¥ç›‘ç®¡å“ªäº›è®¿é—®æ¥æºä¿¡æ¯â€”â€”ä¼šåœ¨ <a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Referer"><code>Referer</code></a> ä¸­å‘é€â€”â€”åº”è¯¥è¢«åŒ…å«åœ¨ç”Ÿæˆçš„è¯·æ±‚å½“ä¸­ã€‚</p><h3 id="Apacheé…ç½®-3"><a href="#Apacheé…ç½®-3" class="headerlink" title="Apacheé…ç½®"></a>Apacheé…ç½®</h3><p>åœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ï¼š</p><pre><code class="hljs pgsql"><span class="hljs-keyword">Header</span> <span class="hljs-keyword">always</span> <span class="hljs-keyword">set</span> Referrer-<span class="hljs-keyword">Policy</span> &quot;no-referrer-when-downgrade&quot;</code></pre><h3 id="è¯­æ³•-2"><a href="#è¯­æ³•-2" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h3><p>æ³¨æ„ <code>Referer</code> å®é™…ä¸Šæ˜¯å•è¯ â€œreferrerâ€ çš„é”™è¯¯æ‹¼å†™ã€‚<code>Referrer-Policy</code> è¿™ä¸ªé¦–éƒ¨å¹¶æ²¡æœ‰å»¶ç»­è¿™ä¸ªé”™è¯¯æ‹¼å†™ã€‚</p><pre><code class="hljs pgsql">Referrer-<span class="hljs-keyword">Policy</span>: <span class="hljs-keyword">no</span>-referrer
Referrer-<span class="hljs-keyword">Policy</span>: <span class="hljs-keyword">no</span>-referrer-<span class="hljs-keyword">when</span>-downgrade
Referrer-<span class="hljs-keyword">Policy</span>: origin
Referrer-<span class="hljs-keyword">Policy</span>: origin-<span class="hljs-keyword">when</span>-<span class="hljs-keyword">cross</span>-origin
Referrer-<span class="hljs-keyword">Policy</span>: same-origin
Referrer-<span class="hljs-keyword">Policy</span>: <span class="hljs-keyword">strict</span>-origin
Referrer-<span class="hljs-keyword">Policy</span>: <span class="hljs-keyword">strict</span>-origin-<span class="hljs-keyword">when</span>-<span class="hljs-keyword">cross</span>-origin
Referrer-<span class="hljs-keyword">Policy</span>: unsafe-url</code></pre><h2 id="Feature-Policy"><a href="#Feature-Policy" class="headerlink" title="Feature-Policy"></a>Feature-Policy</h2><p><strong>è¿™æ˜¯ä¸€ä¸ªå®éªŒä¸­çš„åŠŸèƒ½</strong></p><p>**<code>Feature-Policy</code>**å“åº”å¤´æä¾›äº†ä¸€ç§å¯ä»¥åœ¨æœ¬é¡µé¢æˆ–åŒ…å«çš„iframeä¸Šå¯ç”¨æˆ–ç¦æ­¢æµè§ˆå™¨ç‰¹æ€§çš„æœºåˆ¶ã€‚</p><h3 id="Apacheé…ç½®-4"><a href="#Apacheé…ç½®-4" class="headerlink" title="Apacheé…ç½®"></a>Apacheé…ç½®</h3><p>åœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ï¼š</p><pre><code class="hljs pgsql"><span class="hljs-keyword">Header</span> <span class="hljs-keyword">always</span> <span class="hljs-keyword">set</span> Feature-<span class="hljs-keyword">Policy</span> &quot;vibrate &#x27;self&#x27;; sync-xhr &#x27;self&#x27; https://cdn.defectink.com https://www.defectink.com&quot;</code></pre><h3 id="è¯­æ³•-3"><a href="#è¯­æ³•-3" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h3><pre><code class="hljs gherkin"><span class="hljs-keyword">Feature</span>-Policy: <span class="hljs-variable">&lt;directive&gt;</span> <span class="hljs-variable">&lt;allowlist&gt;</span></code></pre><p><code>&lt;allowlist&gt;</code></p><ul><li><p><code>*</code>: å…è®¸åœ¨å½“å‰æ–‡æ¡£å’Œæ‰€æœ‰åŒ…å«çš„å†…å®¹ï¼ˆæ¯”å¦‚iframesï¼‰ä¸­ä½¿ç”¨æœ¬ç‰¹æ€§ã€‚</p></li><li><p><code>&#39;self&#39;</code>: å…è®¸åœ¨å½“å‰æ–‡æ¡£ä¸­ä½¿ç”¨æœ¬ç‰¹æ€§ï¼Œä½†åœ¨åŒ…å«çš„å†…å®¹ï¼ˆæ¯”å¦‚iframesï¼‰ä»ä½¿ç”¨åŸå€¼ã€‚</p></li><li><p><code>&#39;src&#39;</code>: (åªåœ¨iframeä¸­å…è®¸) åªè¦åœ¨<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/iframe#Attributes">src</a> ä¸­çš„URLå’ŒåŠ è½½iframeç”¨çš„URLç›¸åŒï¼Œåˆ™æœ¬ç‰¹æ€§åœ¨iframeä¸­å…è®¸ï¼Œ</p></li><li><p><code>&#39;none&#39;</code>: ä»æœ€ä¸Šå±‚åˆ°åŒ…å«çš„å†…å®¹éƒ½ç¦æ­¢æœ¬ç‰¹æ€§ã€‚ &lt;origin(s)&gt;: åœ¨ç‰¹å®šçš„æºä¸­å…è®¸ï¼ŒæºURLä»¥ç©ºæ ¼åˆ†å‰²ã€‚</p></li><li><p><code>*</code>: æœ¬ç‰¹æ€§é»˜è®¤åœ¨æœ€ä¸Šå±‚å’ŒåŒ…å«çš„å†…å®¹ä¸­ï¼ˆiframesï¼‰å…è®¸ã€‚</p></li><li><p><code>&#39;self&#39;</code>: æœ¬ç‰¹æ€§é»˜è®¤åœ¨æœ€ä¸Šå±‚å…è®¸ï¼Œè€ŒåŒ…å«çš„å†…å®¹ä¸­ï¼ˆiframesï¼‰ä½¿ç”¨æºåœ°å€ç›¸åŒè®¾å®šã€‚ä¹Ÿå°±æ˜¯è¯´æœ¬ç‰¹æ€§åœ¨iframeä¸­ä¸å…è®¸è·¨åŸŸè®¿é—®ã€‚</p></li><li><p><code>&#39;none&#39;</code>: æœ¬ç‰¹æ€§é»˜è®¤åœ¨æœ€ä¸Šå±‚å’ŒåŒ…å«çš„å†…å®¹ä¸­ï¼ˆiframesï¼‰éƒ½ç¦æ­¢ã€‚</p></li></ul><p><code>*</code>(åœ¨æ‰€æœ‰æºåœ°å€å¯ç”¨)<code>æˆ–&#39;none&#39;</code>(åœ¨æ‰€æœ‰æºåœ°å€ç¦ç”¨)åªå…è®¸å•ç‹¬ä½¿ç”¨ï¼Œè€Œ<code>&#39;self&#39;</code>å’Œ<code>&#39;src&#39;</code>å¯ä»¥ä¸å¤šä¸ªæºåœ°å€ä¸€èµ·ä½¿ç”¨ã€‚</p><p>æ‰€æœ‰çš„ç‰¹æ€§éƒ½æœ‰ä¸€ä¸ªå¦‚ä¸‹çš„é»˜è®¤çš„allowlist</p><ul><li><code>*</code>: æœ¬ç‰¹æ€§é»˜è®¤åœ¨æœ€ä¸Šå±‚å’ŒåŒ…å«çš„å†…å®¹ä¸­ï¼ˆiframesï¼‰å…è®¸ã€‚</li><li><code>&#39;self&#39;</code>: æœ¬ç‰¹æ€§é»˜è®¤åœ¨æœ€ä¸Šå±‚å…è®¸ï¼Œè€ŒåŒ…å«çš„å†…å®¹ä¸­ï¼ˆiframesï¼‰ä½¿ç”¨æºåœ°å€ç›¸åŒè®¾å®šã€‚ä¹Ÿå°±æ˜¯è¯´æœ¬ç‰¹æ€§åœ¨iframeä¸­ä¸å…è®¸è·¨åŸŸè®¿é—®ã€‚</li><li><code>&#39;none&#39;</code>: æœ¬ç‰¹æ€§é»˜è®¤åœ¨æœ€ä¸Šå±‚å’ŒåŒ…å«çš„å†…å®¹ä¸­ï¼ˆiframesï¼‰éƒ½ç¦æ­¢ã€‚</li></ul><h2 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><p><img src="../images/Header%E5%AE%9E%E8%B7%B5-%E5%BE%97%E6%8B%BF%E4%B8%8B%E8%BF%99%E4%B8%AAA/image-20191218171928050.webp" srcset="/images/img/loading.gif" alt="image-20191218171928050"></p><h3 id="ä¸ºä»€ä¹ˆæ²¡æœ‰A-ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆæ²¡æœ‰A-ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆæ²¡æœ‰A+ï¼Ÿ"></a>ä¸ºä»€ä¹ˆæ²¡æœ‰A+ï¼Ÿ</h3><p>å› ä¸ºCSPçš„ä¸€ä¸ªæŠ¥é”™ï¼Œæ‹’ç»åŠ è½½å†…è”çš„JSè„šæœ¬ã€‚å¯ä»¥ä½¿ç”¨<code>unsafe-inline</code>æ¥å¯ç”¨å†…è”è„šæœ¬ã€‚ä½†æ˜¯å¯ç”¨äº†<code>unsafe-inline</code>ä¹‹åï¼Œå°±å¾—ä¸åˆ°A+äº†ã€‚</p><p><img src="../images/Header%E5%AE%9E%E8%B7%B5-%E5%BE%97%E6%8B%BF%E4%B8%8B%E8%BF%99%E4%B8%AAA/image-20191218172218399.webp" srcset="/images/img/loading.gif" alt="image-20191218172218399"></p><pre><code class="hljs routeros">Refused <span class="hljs-keyword">to</span> execute inline<span class="hljs-built_in"> script </span>because it violates the following Content Security<span class="hljs-built_in"> Policy </span>directive: <span class="hljs-string">&quot;script-src &#x27;self&#x27; &#x27;unsafe-eval&#x27; https://maxcdn.bootstrapcdn.com https://ajax.googleapis.com https://cdn.defectink.com&quot;</span>. Either the <span class="hljs-string">&#x27;unsafe-inline&#x27;</span> keyword</code></pre><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Security/HTTP_Strict_Transport_Security">HTTP Strict Transport Security</a></li><li><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CSP">å†…å®¹å®‰å…¨ç­–ç•¥( CSP )</a></li><li><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/X-Content-Type-Options">X-Content-Type-Options</a></li><li><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Referrer-Policy">Referrer-Policy</a></li><li><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Feature-Policy">Feature-Policy</a></li></ul></div><hr><div><div class="post-metas mb-3"><div class="post-meta mr-3"><i class="iconfont icon-category"></i> <a class="hover-with-bg" href="/categories/%E5%AE%9E%E8%B7%B5/">å®è·µ</a></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a class="hover-with-bg" href="/tags/HTML/">HTML</a></div></div><p class="note note-warning"><a target="_blank" href="https://zh.wikipedia.org/wiki/Wikipedia:CC_BY-SA_3.0%E5%8D%8F%E8%AE%AE%E6%96%87%E6%9C%AC" rel="nofollow noopener noopener">CC BY-SA 3.0â¤</a></p><div class="post-prevnext row"><article class="post-prev col-6"><a href="/defect/docker-container-all.html"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">Docker-å…¨é¢å®¹å™¨åŒ–ï¼</span> <span class="visible-mobile">ä¸Šä¸€ç¯‡</span></a></article><article class="post-next col-6"><a href="/defect/docker-build-own-image.html"><span class="hidden-mobile">Docker-æ„å»ºå±äºè‡ªå·±çš„é•œåƒ</span> <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span><i class="iconfont icon-arrowright"></i></a></article></div></div><article class="comments" id="comments"><div id="vcomments"></div><script type="text/javascript">function loadValine(){addScript("https://cdn.defectink.com/static/valine/1.4.14/Valine.min.js",function(){new Valine({el:"#vcomments",app_id:"dD9t7mcIBVzJWag5ez6GPy2v-MdYXbMMI",app_key:"bWG6pmKsEscrH4JjrpNNAAy6",placeholder:"å˜¤å˜¤å˜¤ï¼Ÿï¼Ÿï¼Ÿ",path:window.location.pathname,avatar:"retro",meta:["nick","mail","link"],pageSize:"10",lang:"zh-CN",highlight:!0,recordIP:!1,serverURLs:""})})}waitElementVisible("vcomments",loadValine)</script><noscript>Please enable JavaScript to view the <a target="_blank" href="https://valine.js.org" rel="nofollow noopener noopener">comments powered by Valine.</a></noscript></article></article></div></div></div><div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;ç›®å½•</p><div id="tocbot"></div></div></div></div></div></main><a id="scroll-top-button" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">å…³é”®è¯</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div><footer class="text-center mt-5 py-3"><div class="footer-content"><a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a><i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a></div><div class="beian"><a href="http://beian.miit.gov.cn/" target="_blank" rel="nofollow noopener">çš–ICPå¤‡17017808å·</a></div></footer><script src="https://cdn.defectink.com/static/jquery/3.4.1/jquery.min.js"></script><script src="https://cdn.defectink.com/static/twitter-bootstrap/4.5.3/js/bootstrap.min.js"></script><script src="/js/debouncer.js"></script><script src="/js/main.js"></script><script src="/js/lazyload.js"></script><script defer="defer" src="https://cdn.defectink.com/static/clipboard.js/2.0.6/clipboard.min.js"></script><script src="/js/clipboard-use.js"></script><script src="/js/xfy.js"></script><script src="https://cdn.defectink.com/static/tocbot/4.11.1/tocbot.min.js"></script><script>$(document).ready(function(){var t=$("#board-ctn").offset().top;tocbot.init({tocSelector:"#tocbot",contentSelector:"#post-body",headingSelector:"h1,h2,h3,h4,h5,h6",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",collapseDepth:3,scrollSmooth:!0,headingsOffset:-t}),0<$(".toc-list-item").length&&$("#toc").css("visibility","visible")})</script><script src="https://cdn.defectink.com/static/typed.js/2.0.11/typed.min.js"></script><script>var typed=new Typed("#subtitle",{strings:["  ","Headerå®è·µ-å¾—æ‹¿ä¸‹è¿™ä¸ªA&nbsp;"],cursorChar:"â¤",typeSpeed:70,loop:!1});typed.stop(),$(document).ready(function(){$(".typed-cursor").addClass("h2"),typed.start()})</script><script src="/js/local-search.js"></script><script>var path="/xml/local-search.xml",inputArea=document.querySelector("#local-search-input");inputArea.onclick=function(){searchFunc(path,"local-search-input","local-search-result"),this.onclick=null}</script><script src="https://cdn.defectink.com/static/fancybox/3.5.7/jquery.fancybox.min.js"></script><link rel="stylesheet" href="https://cdn.defectink.com/static/fancybox/3.5.7/jquery.fancybox.min.css"><script>$("#post img:not(.no-zoom img, img[no-zoom]), img[zoom]").each(function(){var t=document.createElement("a");$(t).attr("data-fancybox","images"),$(t).attr("href",$(this).attr("src")),$(this).wrap(t)})</script><script src="https://cdn.defectink.com/static/mermaid/8.5.0/mermaid.min.js"></script><script>window.mermaid&&mermaid.initialize({theme:"default"})</script></body></html>