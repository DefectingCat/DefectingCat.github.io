---
title: ç»å…¸è½®æ’­å›¾çš„å®ç°æ–¹æ¡ˆ
date: 2021-02-09 13:37:00
tags: [Vue, JavaScript]
categories: å®è·µ
url: classic-slidershow
index_img: /images/ç»å…¸è½®æ’­å›¾çš„å®ç°æ–¹æ¡ˆ/logo.webp
---

## ä¼ ç»Ÿæ–¹å¼

[é¡¹ç›®åœ°å€](https://git.defectink.com/xfy/classic-slider)

ä¼ ç»Ÿæ–¹å¼å®ç°è½®æ’­ä¹Ÿç®—ä¸€ä¸ªä¸å°çš„å·¥ç¨‹é‡äº†ï¼ŒåŸºæœ¬å¸ƒå±€å°±æ˜¯å°†æ‰€æœ‰çš„å›¾ç‰‡æ¨ªå‘å¸ƒå±€ï¼Œå¹¶åœ¨é¦–ä½åˆ†åˆ«å…‹éš†æœ€åå’Œç¬¬ä¸€å¼ å›¾ç‰‡ã€‚å½“åˆ‡æ¢åˆ°å…‹éš†çš„å›¾ç‰‡æ—¶ï¼Œå¹¶åœ¨åŠ¨ç”»æ’­æ”¾å¿«ç»“æŸæ—¶ï¼Œå°†è¿™ä¸ªå›¾ç‰‡é˜Ÿåˆ—å¤ä½ã€‚

![](../images/ç»å…¸è½®æ’­å›¾çš„å®ç°æ–¹æ¡ˆ/2021-02-13-15-37-51.webp)

å½“æ•´ä¸ªé˜Ÿåˆ—åˆ‡æ¢å®Œäº†ä¹‹åï¼Œä¼šåˆ‡æ¢åˆ°å…‹éš†çš„ #1 å›¾ç‰‡ä¸Šï¼Œå†åŠ¨ç”»å®Œæˆä¹‹åï¼Œæˆ‘ä»¬æ‚„æ‚„çš„å°†å…¶åˆ‡æ¢ä¸ºçœŸæ­£çš„ç¬¬ä¸€å¼ å›¾ç‰‡ã€‚

![](../images/ç»å…¸è½®æ’­å›¾çš„å®ç°æ–¹æ¡ˆ/2021-02-13-15-39-13.webp)

## ä¼ ç»Ÿæ–¹å¼çš„å®ç°

ä¸ºäº†ç»™å„ç§æ•°é‡çš„å›¾ç‰‡åšé€‚åº”ï¼Œæ‰€ä»¥æ•´ä¸ªé˜Ÿåˆ—çš„å®½åº¦å°±ä¸å›ºå®šæ­»äº†ï¼Œè€Œä½¿ç”¨ JavaScript åŠ¨æ€ç”Ÿæˆï¼ŒåŒ…æ‹¬å›¾ç‰‡ç´¢å¼•çš„å°åœ†ç‚¹ã€‚

### HTML

æ•´ä¸ªæ¡†æ¶éå¸¸çš„ç®€å•ï¼Œä¸€ä¸ªå¤–å±‚ div ä¸­æœ‰ä¸‰ä¸ªä¸»è¦çš„ç»“æ„ï¼Œåˆ†åˆ«æ˜¯ï¼šç”¨äºå­˜æ”¾å›¾ç‰‡çš„æ— åºåˆ—è¡¨ã€å·¦å³æŒ‰é’®å’Œå°åœ†ç‚¹ç´¢å¼•ã€‚

```html
<div class="wrapper">
  <div class="slider" id="slider">
    <ul class="clear-fix">
      <li><img src="./img/1.jpg" alt="" class="roll-img" /></li>
      <li><img src="./img/2.png" alt="" class="roll-img" /></li>
      <li><img src="./img/3.png" alt="" class="roll-img" /></li>
      <li><img src="./img/4.jpg" alt="" class="roll-img" /></li>
      <li><img src="./img/5.jpg" alt="" class="roll-img" /></li>
    </ul>
    <div class="btn btn-left">
      <span><</span>
    </div>
    <div class="btn btn-right">
      <span>></span>
    </div>
    <div class="index-box">
      <ol></ol>
    </div>
  </div>
</div>
```

### CSS

CSS æ–¹é¢ï¼Œä¸»è¦å€¼å¾—æ³¨æ„çš„å°±æ˜¯ ul å’Œ liï¼Œä»–ä»¬åˆ†åˆ«ä¸ºç»å¯¹å®šä½`position: absolute;`å’Œå·¦æµ®åŠ¨`float: left;`ã€‚

å¯¹ ul ä½¿ç”¨ç»å¯¹å®šä½å°±å¯ä»¥æ§åˆ¶å…¶`left`å±æ€§æ¥å®ç°å·¦å³ç§»åŠ¨çš„åŠ¨ç”»æ•ˆæœã€‚è€Œå¯¹ li ä½¿ç”¨å·¦æµ®åŠ¨æ˜¯ä¸ºäº†å°†æ‰€æœ‰çš„å›¾ç‰‡éƒ½æ’åˆ—æˆä¸€è¡Œã€‚

```css
.slider {
  transition: all 300ms;
  position: relative;
  height: 100%;
  border-radius: 14px;
  /* overflow: hidden; */
}
.slider ul {
  position: absolute;
  top: 0;
  left: -400px;
  /* width: 700%; */
  /* height: 100%; */
  list-style: none;
}
.slider ul li {
  float: left;
}

.roll-img {
  width: 400px;
}

.clear-fix::after {
  content: "";
  clear: both;
  display: block;
  height: 0;
}
```

## JavaScript

JavaScript æ–¹é¢å†…å®¹å€¼å¾—ä¸ºå®ƒå†™æˆä¸€ä¸ªäºŒçº§æ ‡é¢˜ã€‚å®ƒæœ‰å¤šä¸ªéƒ¨åˆ†ç»„æˆï¼Œåœ¨ JavaScript åšçš„äº‹æƒ…æœ‰ï¼š

* åŠ¨æ€æ ¹æ®å›¾ç‰‡ç”Ÿæˆåœ†ç‚¹ï¼›
* å…‹éš†éœ€è¦çš„å›¾ç‰‡èŠ‚ç‚¹ï¼›
* åŠ¨æ€æ·»åŠ å°åœ†ç‚¹æ ·å¼ï¼›
* å·¦å³ç¿»é¡µæŒ‰é’®çš„ç›‘å¬å™¨ï¼›
* ç§»åŠ¨æ–¹æ³•ï¼›
* é‡ç½®æ•´ä¸ªå›¾ç‰‡é˜Ÿåˆ—ï¼›

### åˆå§‹åŒ–

è¿™æ¬¡ä½¿ç”¨ ES6 çš„ class æ¥åˆ›å»ºå¯¹è±¡ï¼Œå¹¶åˆå§‹åŒ–æ•´ä¸ªè½®æ’­å›¾ã€‚ç¬¬ä¸€æ­¥è¦åšçš„å°±æ˜¯åœ¨`constructor()`ä¸­é€‰ä¸­å’Œå®šä¹‰éœ€è¦çš„æ•°æ®ï¼š

```js
class Slider {
  constructor(id) {
    // å¤–å±‚div
    this.wrapper = document.querySelector(id);
    this.pics = this.wrapper.querySelector('ul');
    // å°åœ†ç‚¹å¤–å±‚
    this.index = this.wrapper.querySelector('.index-box');
    // å°åœ†ç‚¹ç´¢å¼•
    this.indexPoint = 1;
    // å•ä¸ªå›¾ç‰‡å®½åº¦
    this.picWidth = this.wrapper.clientWidth;
    // æ€»å…±å›¾ç‰‡ä¸ªæ•°
    this.sliders = this.pics.children.length;
    // æŒ‰é’®ç‚¹å‡»é—´éš”
    this.startMs = Date.now();
    // ç‚¹å‡»å°åœ†ç‚¹çš„é—´éš”
    this.movePoint = 0;
    // åˆå§‹åŒ–æ–¹æ³•
    this.init();
  }
}
```

`init()`æ–¹æ³•ä¸­ä¸»è¦å°±æ˜¯å…¶ä»–ä¸€äº›æ–¹æ³•çš„é›†ä¸­è¿è¡Œï¼Œä»–ä»¬åˆ†åˆ«æ˜¯ï¼šåˆå§‹åŒ–åœ†ç‚¹ã€å…‹éš†å›¾ç‰‡å’Œå·¦å³æŒ‰é’®ï¼š

```js
  init() {
    console.log('init!');
    this.initPoint();
    this.clonePic();
    this.lR();
  }
```

### åˆå§‹åŒ–åœ†ç‚¹

åˆå§‹åŒ–åœ†ç‚¹ä¸»è¦åšçš„ä¸‰ä»¶äº‹ï¼š

1. æ ¹æ®å›¾ç‰‡æ•°é‡ç”Ÿæˆåœ†ç‚¹ä¸ªæ•°ï¼›
2. ä¸ºç¬¬ä¸€ä¸ªåœ†ç‚¹æ·»åŠ æ¿€æ´»çš„æ ·å¼ï¼›
3. ç›‘å¬ç‚¹å‡»äº‹ä»¶ï¼›

è¿™é‡Œä½¿ç”¨äº† document fragment æ¥å°†æ‰€æœ‰ç”Ÿæˆçš„åœ†ç‚¹ä¸€æ¬¡æ€§çš„æ’å…¥åˆ° DOM é‡Œï¼Œä»è€Œå‡å°‘æ“ä½œ DOM çš„é¢‘ç‡ã€‚

å…¶ä¸­æ¯”è¾ƒå¤æ‚çš„éƒ¨åˆ†åœ¨äºç›‘å¬ç‚¹å‡»äº‹ä»¶ï¼Œå®ƒä¸ä»…ä»…è¦ä¸ºç‚¹å‡»çš„åœ†ç‚¹æ·»åŠ ç›¸åº”æ¿€æ´»çš„æ ·å¼ï¼Œè¿˜è¦åˆ¤æ–­åœ†ç‚¹çš„å·¦å³å’Œè·ç¦»æ¥ç§»åŠ¨å¯¹åº”è·ç¦»çš„å›¾ç‰‡ã€‚

åœ¨äº‹ä»¶ä»£ç†é‡Œï¼Œéœ€è¦åšä¸€ä¸ªå°åˆ¤æ–­`if (e.target.nodeName.toString().toLowerCase() == 'li')`ï¼Œä¸ç„¶ç‚¹å‡»åˆ°äº†çˆ¶ div å…ƒç´ ä¼šå–ä¸åˆ°å¯¹åº”çš„å±æ€§è€ŒæŠ¥é”™ã€‚

è¿™é‡Œåˆ¤æ–­ç‚¹å‡»åœ†ç‚¹åçš„å·¦å³ç§»åŠ¨ä½¿ç”¨æ—¶ï¼Œå®šä¹‰äº†ä¸¤ä¸ªå˜é‡ï¼Œä»–ä»¬åˆ†åˆ«æ˜¯ï¼š

```js
    // å°åœ†ç‚¹ç´¢å¼•
    this.indexPoint = 1;
    // ç‚¹å‡»å°åœ†ç‚¹çš„é—´éš”
    this.movePoint = 0;
```

`this.indexPoint`å°±æ˜¯è‡ªå®šä¹‰çš„ Attributeï¼Œé€šè¿‡åˆ¤æ–­`this.indexPoint`ä¸Šä¸€æ¬¡å’Œè¿™ä¸€æ¬¡ç‚¹å‡»çš„å¤§å°ï¼Œå°±å¯ä»¥åˆ¤æ–­å‡ºç‚¹å‡»çš„åœ†ç‚¹æ˜¯åœ¨å·¦è¾¹è¿˜æ˜¯åœ¨å³è¾¹ï¼Œä»è€Œå‘å¯¹åº”çš„æ–¹å‘ç§»åŠ¨å›¾ç‰‡ã€‚

è€Œå›¾ç‰‡ç§»åŠ¨çš„è·ç¦»ä½¿åˆ™å°±æ˜¯`å°åœ†ç‚¹çš„é—´éš” * å•å¼ å›¾ç‰‡çš„å®½åº¦`ï¼Œè¿™é‡Œè°ƒç”¨çš„æ˜¯è‡ªå®šä¹‰çš„`move()`æ–¹æ³•ï¼Œå®ƒæ¥å—çš„å‚æ•°å°±æ˜¯å›¾ç‰‡ç§»åŠ¨çš„è·ç¦»`this.move(-this.picWidth * this.movePoint);`ã€‚

`this.picWidth`æ˜¯æå‰å®šä¹‰å¥½çš„å•å¼ å›¾ç‰‡çš„å®½åº¦ï¼Œé€šè¿‡`this.wrapper.clientWidth;`æ¥è·å–

```js
  initPoint() {
    // è·å–å›¾ç‰‡çš„æ€»ä¸ªæ•°
    let num = this.pics.children.length;
    // ä½¿ç”¨ fragment ç‰‡æ®µæ¥åªæ“ä½œä¸€æ¬¡ DOM æ’å…¥æ‰€æœ‰åœ†ç‚¹
    let frg = document.createDocumentFragment();
    // å¾ªç¯ç”Ÿæˆ
    for (let i = 0; i < num; i++) {
      let li = document.createElement('li');
      // è®¾ç½®è‡ªå®šä¹‰ Attributeï¼Œç”¨æ¥æ ‡è¯†å’Œåº”ç”¨æ ·å¼ï¼›
      li.setAttribute('data-index', i + 1);
      // é»˜è®¤æ¿€æ´»çŠ¶æ€
      if (i == 0) {
        li.className = 'active';
      }
      // æ’å…¥åˆ° fragment
      frg.append(li);
    }
    // åŠ¨æ€ç”Ÿæˆ ol å®½åº¦
    this.index.children[0].style.width = num * 10 * 2 + 'px';
    this.index.children[0].append(frg);
    // æ·»åŠ ç‚¹å‡»äº‹ä»¶ï¼Œè·å–index
    this.index.children[0].addEventListener('click', (e) => {
      // åˆ©ç”¨äº‹ä»¶å†’æ³¡åšäº‹ä»¶ä»£ç†ï¼Œåªç‚¹å‡»åˆ° li å…ƒç´ ç”Ÿæ•ˆ
      if (e.target.nodeName.toString().toLowerCase() == 'li') {
        let ip = e.target.getAttribute('data-index');
        // åˆ¤æ–­ç‚¹å‡»çš„åœ†ç‚¹é—´éš”ï¼Œä»è€Œå†³å®šç§»åŠ¨å¤šå°‘å›¾ç‰‡
        if (this.indexPoint < ip) {
          this.movePoint = ip - this.indexPoint;
          this.indexPoint = Number(ip);
          // è°ƒç”¨ move() æ–¹æ³•æ¥ç§»åŠ¨å›¾ç‰‡ï¼Œç§»åŠ¨çš„è·ç¦»ä¸ºåœ†ç‚¹çš„é—´éš” * å•å¼ å›¾ç‰‡çš„å®½åº¦
          this.move(-this.picWidth * this.movePoint);
        } else {
          this.movePoint = this.indexPoint - ip;
          this.indexPoint = Number(ip);
          this.move(this.picWidth * this.movePoint);
        }
      }
    });
  }
```

### å…‹éš†èŠ‚ç‚¹

å‰é¢æ›¾æåˆ°è¿‡ï¼Œéœ€è¦æ‰‹åŠ¨çš„å…‹éš†å‰åä¸¤å¼ å›¾ç‰‡ï¼Œå¹¶å†å°†å…¶æ”¾è°ƒæ¢æ”¾åœ¨å‰åã€‚ç”±äºåœ¨ç¬¬ä¸€å¼ å›¾ç‰‡çš„å‰é¢æ·»åŠ äº†ä¸€å¼ å…‹éš†çš„æœ€åä¸€å¼ å›¾ï¼Œæ‰€ä»¥éœ€è¦å°† ul çš„å·¦åç§»æå‰è®¾ç½®ä¸ºè´Ÿçš„ä¸€å¼ å›¾ç‰‡çš„å®½åº¦ã€‚

å¹¶ä¸”æ•´ä¸ª ul çš„å®½åº¦ä¸ºæ‰€æœ‰å›¾ç‰‡åŠ åœ¨ä¸€èµ·çš„å®½åº¦ã€‚

```js
  clonePic() {
    // å…‹éš†ç¬¬ä¸€ä¸ªå…ƒç´ 
    let first = this.pics.firstElementChild.cloneNode(true);
    // å…‹éš†æœ€åä¸€ä¸ªå…ƒç´ 
    let last = this.pics.lastElementChild.cloneNode(true);
    this.pics.append(first);
    this.pics.insertBefore(last, this.pics.firstElementChild);
    // åŠ¨æ€è®¾å®šå®½åº¦
    this.pics.style.width = this.pics.children.length * 100 + '%';
    // åŠ¨æ€è®¾å®šæ¼‚ç§»
    this.pics.style.left = -1 * this.picWidth + 'px';
  }
```

### å·¦å³æŒ‰é’®

å·¦å³ç¿»é¡µæŒ‰é’®çš„åŸºæœ¬æ¡†æ¶åœ¨ HTML ä¸­å·²ç»å†™å¥½ï¼Œæ¥ä¸‹æ¥å°±æ˜¯åŠ¨æ€çš„ç›‘å¬äº‹ä»¶äº†ã€‚

è¿™ä¸¤ä¸ªæŒ‰é’®é‡Œä¸»è¦å°±æ˜¯ç›‘å¬ç‚¹å‡»çš„äº‹ä»¶ï¼Œä¸»è¦çš„åŠŸèƒ½è¿˜æ˜¯åœ¨ç§»åŠ¨æ–¹æ³•`move()`é‡Œã€‚

è¿™é‡Œè¿˜åœ¨æ¯æ¬¡ç‚¹å‡»ç»“æŸåè®°å½•äº†ä¸‹å½“å‰çš„æ—¶é—´æˆ³ï¼Œå½“å†æ¬¡ç‚¹å‡»æŒ‰é’®æ—¶ä¼šæ¯”è¾ƒå½“å‰ç‚¹å‡»çš„æ—¶é—´æˆ³å’Œè®°å½•çš„æ—¶é—´æˆ³ï¼Œå¦‚æœå°äº 310ms åˆ™ä»€ä¹ˆä¹Ÿä¸åšã€‚

```js
  lR() {
    // é€‰ä¸­å·¦å³æŒ‰é’®ï¼Œå¹¶æ·»åŠ ç›‘å¬å™¨
    this.wrapper.querySelector('.btn-left').addEventListener('click', () => {
      // è®°å½•ä¸Šä¸€æ¬¡ç‚¹å‡»çš„æ—¶é—´æˆ³ï¼Œ310ms å†…çš„è¿ç»­ç‚¹å‡»å°†ä¸ç”Ÿæ•ˆ
      if (Date.now() - this.startMs > 310) {
        // åœ†ç‚¹è¶Šç•Œæ—¶é‡ç½®å…¶ index
        if (this.indexPoint - 1 < 1) {
          this.indexPoint = this.sliders;
        } else {
          this.indexPoint--;
        }
        this.move(this.picWidth);
        this.startMs = Date.now();
      }
    });
    this.wrapper.querySelector('.btn-right').addEventListener('click', () => {
      // è®°å½•ä¸Šä¸€æ¬¡ç‚¹å‡»çš„æ—¶é—´æˆ³ï¼Œ310ms å†…çš„è¿ç»­ç‚¹å‡»å°†ä¸ç”Ÿæ•ˆ
      if (Date.now() - this.startMs > 310) {
        // åœ†ç‚¹è¶Šç•Œæ—¶é‡ç½®å…¶ index
        if (this.indexPoint + 1 > this.sliders) {
          this.indexPoint = 1;
        } else {
          this.indexPoint++;
        }
        this.move(-this.picWidth);
        this.startMs = Date.now();
      }
    });
  }
```

### ç§»åŠ¨æ–¹æ³•

åœ¨å‰é¢çš„æŒ‰é’®é‡Œè°ƒç”¨äº†ç§»åŠ¨æ–¹æ³•`move()`ï¼Œå¹¶ä¼ é€’äº†ä¸€ä¸ªå®½åº¦ä½œä¸ºå‚æ•°ã€‚è¿™ä¸ªå‚æ•°å°±ç”¨ä½œäº css çš„`left`å€¼ï¼Œå½“ä¸ºè´Ÿæ•°æ—¶æ•´ä¸ªé˜Ÿåˆ—å‘å·¦ç§»åŠ¨ï¼Œåä¹‹ï¼Œå‘å³ç§»åŠ¨ã€‚

ä»”ç»†ä¸€çœ‹ä¹Ÿä¸æ˜¯éå¸¸çš„å¤æ‚ï¼ŒåŸºæœ¬çš„ç§»åŠ¨æ–¹æ³•å°±æ˜¯ï¼šè·å–å½“å‰çš„`left`å€¼ï¼Œç„¶ååŠ ä¸Šä¼ é€’è¿›æ¥çš„ width å‚æ•°ï¼Œæœ€åæœ€ä¸ºæœ€æ–°çš„`left`å€¼èµ‹å€¼åˆ° ul ä¸Šã€‚

æœ€é‡è¦çš„ï¼Œä¹Ÿå°±æ˜¯æ•´ä¸ªè½®æ’­å›¾çš„æ ¸å¿ƒéƒ¨åˆ†å°±æ˜¯é‡ç½®é˜Ÿåˆ—é‚£éƒ¨åˆ†ã€‚å½“å½“å‰çš„`left`å€¼ç­‰äºè´Ÿçš„ç¬¬ä¸€å¼ å›¾ç‰‡æ—¶ï¼Œä¹Ÿå°±æ˜¯é˜Ÿåˆ—æ»šåŠ¨åˆ°äº†å…‹éš†çš„ #5 å›¾ç‰‡ä¸Šäº†ã€‚å›¾ç‰‡åˆ‡æ¢åŠ¨ç”»çš„æ—¶é—´æ˜¯ 300msï¼Œåœ¨ç¬¬ 295ms æ—¶æˆ‘ä»¬å°±éœ€è¦æ‚„æ‚„çš„å°† ul çš„åŠ¨ç”»ç§»é™¤ï¼Œå¹¶å°†æ•´ä¸ªé˜Ÿåˆ—ç§»åŠ¨åˆ°æ­£çœŸçš„ç¬¬äº”å¼ å›¾ç‰‡ä¸Šã€‚è¿™æ ·å°±å¯ä»¥å®ç°æ— ç¼çš„è½®æ’­æ»šåŠ¨äº†ã€‚åä¹‹äº¦ç„¶ã€‚

![](../images/ç»å…¸è½®æ’­å›¾çš„å®ç°æ–¹æ¡ˆ/2021-02-13-15-37-51.webp)

```js
  move(width) {
    // è·å–å½“å‰çš„ left å€¼
    let left = parseFloat(this.pics.style.left);
    // æ·»åŠ  300ms çš„åŠ¨ç”»
    this.pics.style.transition = `all 300ms`;
    // é€šè¿‡ç§»åŠ¨æ­£è´Ÿå€¼æ¥ç¡®å®šå·¦å³
    this.pics.style.left = left + width + 'px';
    // ç‹¸çŒ«æ¢å¤ªå­
    if (left == -this.picWidth && width > 0) {
      // åŠ¨ç”»ä¸º300msï¼Œå½“ä¸ºæœ€åä¸€å¼ å›¾çš„æ—¶å€™ï¼Œ295msåæ›¿æ¢æ•´ä¸ªul
      setTimeout(() => {
        this.pics.style.transition = `none`;
        this.pics.style.left = -this.sliders * this.picWidth + 'px';
      }, 295);
    } else if (left == -this.sliders * this.picWidth && width < 0) {
      setTimeout(() => {
        this.pics.style.transition = `none`;
        this.pics.style.left = -this.picWidth + 'px';
      }, 290);
    }
    // åº”ç”¨åœ†ç‚¹æ ·å¼
    this.modIndexPoint();
  }
```

### åŠ¨æ€æ·»åŠ åœ†ç‚¹æ ·å¼

æœ€åä¸€ä¸ªå°åŠŸèƒ½å°±æ˜¯åŠ¨æ€çš„æ·»åŠ åœ†ç‚¹çš„æ¿€æ´»æ ·å¼ï¼Œè¿™ä¸ªéƒ¨åˆ†éå¸¸çš„ç®€å•ï¼Œä¸€äº›åŸºæœ¬æ“ä½œã€‚

é¦–å…ˆå°†æ‰€æœ‰çš„åœ†ç‚¹çš„æ ·å¼éƒ½ç§»é™¤ï¼Œç„¶ååœ¨ç´¢å¼•çš„åœ†ç‚¹ä¸Šæ·»åŠ `active`çš„æ ·å¼ã€‚

```js
  modIndexPoint() {
    let points = Array.from(this.index.children[0].children);
    for (let i of points) {
      i.className = '';
    }
    points[this.indexPoint - 1].className = 'active';
  }
```

## Vue

[é¡¹ç›®åœ°å€](https://git.defectink.com/xfy/vue-slider)

Vue ç”±æ•°æ®é©±åŠ¨ï¼Œé…åˆä¸Šå…¶è¿‡æ¸¡æ ·å¼ï¼Œå¯ä»¥è½»æ¾å®ç°å¦ä¸€ç§æ— é™è½®æ’­çš„æ–¹æ¡ˆã€‚

### æ•°æ®é©±åŠ¨

å°†æ‰€æœ‰çš„å›¾ç‰‡éƒ½ä½¿ç”¨`position: absolute`å®šä½ä¿æŒåœ¨åŒä¸€ä¸ªä½ç½®ï¼Œç„¶åé…åˆ`v-show`æ¥æ˜¾ç¤ºå›¾ç‰‡ã€‚å½“å›¾ç‰‡èƒ½å¤ŸæˆåŠŸæ˜¾ç¤ºæ—¶ï¼Œé…åˆ Vue çš„è¿‡æ¸¡åŠ¨ç”»å°±èƒ½å¤Ÿå®ç°æ— ç¼çš„åˆ‡æ¢äº†ã€‚

è¿™é‡Œä½¿ç”¨äº†`v-for`æ¥åŠ¨æ€çš„åˆ›å»ºå›¾ç‰‡ DOMï¼Œå¤–å±‚ç”±`transition-group`å®šä¹‰ä¸º ulï¼Œè€Œå†…éƒ¨ li åˆ™å°è£…ä¸ºä¸€ä¸ªç»„ä»¶ï¼š

```html
    <transition-group :name="dest" tag="ul" class="img">
      <ImgItem v-for="(item, i) in images" :key="item.id" v-show="show == i">
        <template>
          <img :src="item.src" />
        </template>
      </ImgItem>
    </transition-group>
```

è€Œ`v-show`å‘¢ï¼Œåˆ™é…åˆ images åˆ—è¡¨çš„ä¸‹æ ‡æ˜¾ç¤ºï¼Œå½“å›¾ç‰‡çš„ä¸‹æ ‡ä¸å®šä¹‰çš„å˜é‡ show ç›¸åŒæ—¶`v-show="show == i"`åˆ™æ˜¾ç¤ºè¿™ä¸ªå›¾ç‰‡ã€‚

```js
data() {
  return {
    images: [
      { id: 1, src: require('../../assets/img/1.webp') },
      { id: 2, src: require('../../assets/img/2.webp') },
      { id: 3, src: require('../../assets/img/3.webp') },
      { id: 4, src: require('../../assets/img/4.webp') },
      { id: 5, src: require('../../assets/img/5.webp') }
    ],
    show: 0,
  }
```

### åˆ‡æ¢å›¾ç‰‡

åœ¨è€ƒè™‘è¿‡æ¸¡åŠ¨ç”»ä¹‹å‰ï¼Œåº”è¯¥å…ˆæŠŠåˆ‡æ¢å›¾ç‰‡çš„åŠŸèƒ½åšå¥½ã€‚

åˆ‡æ¢åŠŸèƒ½éå¸¸çš„ç®€å•ï¼Œåˆšåˆšå®šä¹‰çš„ show å˜é‡ä¾¿æ˜¯é©±åŠ¨å›¾ç‰‡æ˜¾ç¤ºçš„æ•°æ®ã€‚è€Œåˆ‡æ¢å›¾ç‰‡åªè¦å¢åŠ å’Œå‡å°‘è¿™ä¸ª show å˜é‡å³å¯ï¼Œåªéœ€è¦æ³¨æ„é˜²æ­¢å…¶è¶Šç•Œã€‚

```html
    <div class="btn btn-left" @click="previous">
      <ImgBtn>
        <template>
          <i class="iconfont icon-next"></i>
        </template>
      </ImgBtn>
    </div>
    <div class="btn btn-right" @click="next">
      <ImgBtn>
        <template>
          <i class="iconfont icon-next"></i>
        </template>
      </ImgBtn>
    </div>
```

è¿™é‡Œçš„`this.dest`æ˜¯ç¨åç”¨ä½œåŠ¨ç”»è¿‡æ¸¡è€Œå®šä¹‰çš„æ–¹å‘ã€‚

```js
methods: {
  next() {
    this.dest = 'img-next';
    this.show == this.images.length - 1 ? (this.show = 0) : this.show++;
  },
  previous() {
    this.dest = 'img-previous';
    this.show == 0 ? (this.show = this.images.length - 1) : this.show--;
  },
}
```

### å°åœ†ç‚¹

åŒæ ·çš„å°åœ†ç‚¹ä¹Ÿæ˜¯å°è£…ä¸ºä¸€ä¸ªå°ç»„ä»¶ï¼Œå¤–éƒ¨ç›´æ¥ä½¿ç”¨ ol æ¥åµŒå¥—ã€‚åŒæ ·çš„ï¼Œå°åœ†ç‚¹çš„æ•°é‡ç”±å›¾ç‰‡æ¥å†³å®šï¼Œæ‰€ä»¥å®ƒä¹Ÿæ˜¯éå†`v-for`images æ•°ç»„ã€‚

è€Œå°åœ†ç‚¹çš„æ¿€æ´»æ ·å¼åŒæ ·çš„ä¹Ÿæ˜¯ç”±å˜é‡ show æ¥è¿›è¡Œé©±åŠ¨ï¼Œå½“ show ç­‰äºå½“å‰ä¸‹æ ‡æ—¶ï¼Œåˆ™æ¿€æ´»æ ·å¼ã€‚å°åœ†ç‚¹å’Œå›¾ç‰‡çš„æ¿€æ´»éƒ½ç”±åŒä¸€ä¸ªå˜é‡é©±åŠ¨ï¼Œè¿™æ ·åœ¨ä¿®æ”¹è¿™ä¸€ä¸ªå˜é‡æ—¶ï¼Œå°åœ†ç‚¹å’Œå›¾ç‰‡éƒ½èƒ½æ­£ç¡®åˆ‡æ¢åˆ°å¯¹åº”çš„åºåˆ—ã€‚

```html
    <ol class="img-point" @click="pointClick">
      <ImgPoint v-for="(item, i) in images" :key="item.id + 'point'">
        <template>
          <i :class="{ active: show == i }" :id="i"></i>
        </template>
      </ImgPoint>
    </ol>
```

å°åœ†ç‚¹è¿™é‡Œç»‘å®šäº†ä¸€ä¸ª id ä¸ºæ•°ç»„ä¸‹æ ‡ï¼Œè¿™æ ·å½“ç‚¹å‡»åˆ°å½“å‰ä¸‹æ ‡çš„åœ†ç‚¹æ—¶ï¼Œå°±èƒ½é€šè¿‡äº‹ä»¶ä¿®æ”¹ show çš„å€¼äº†ã€‚è¿™é‡Œäº‹ä»¶åŒæ ·ä½¿ç”¨äº‹ä»¶ä»£ç†ã€‚

è¿™é‡Œçš„ if åˆ¤æ–­æ˜¯ç”¨æ¥åˆ¤æ–­åç»­è¿‡æ¸¡åŠ¨ç”»çš„æ–¹å‘çš„ã€‚

```js
    pointClick(e) {
      console.log(e.target.id);
      if (e.target.nodeName.toString().toLowerCase() == 'i') {
        this.show > e.target.id
          ? (this.dest = 'img-previous')
          : (this.dest = 'img-next');
        this.show = e.target.id;
      }
    },
```

### è¿‡æ¸¡åŠ¨ç”»

è¿™é‡Œä½¿ç”¨äº† Vue çš„è¿‡æ¸¡æ•ˆæœï¼Œæ­£å‘ç§»åŠ¨æ—¶ï¼Œå°†å³å°†è¿›å…¥çš„å›¾ç‰‡å‘å³åç§»ä¸€ä¸ªè‡ªèº«å®½åº¦ï¼Œç„¶åå†æ…¢æ…¢çš„è¿‡æ¸¡è¿›å½“å‰çš„åŒºåŸŸï¼Œç¦»å¼€çš„å›¾ç‰‡ä¹Ÿæ˜¯åŒç†ï¼Œæ…¢æ…¢çš„è¿‡æ¸¡åˆ°å‘å·¦åç§»ä¸€ä¸ªè‡ªèº«å®½åº¦ã€‚

![](../images/ç»å…¸è½®æ’­å›¾çš„å®ç°æ–¹æ¡ˆ/2021-02-02-14-52-48.webp)

```css
.img-next-enter-active,
.img-next-leave-active,
.img-previous-enter-active,
.img-previous-leave-active {
  transition: all 300ms;
}
.img-next-enter,
.img-previous-leave-to {
  transform: translateX(100%);
}
.img-next-enter-to,
.img-next-leave,
.img-previous-enter-to,
.img-previous-leave {
  transform: translateX(0);
}
.img-next-leave-to,
.img-previous-enter {
  transform: translateX(-100%);
}
```

ç¨å¾®å¤æ‚ä¸€ç‚¹çš„å°±æ˜¯å·¦å³æ–¹å‘ç§»åŠ¨æ—¶ï¼Œå¯¹åº”çš„åŠ¨ç”»é¡ºåºæ˜¯ä¸ä¸€æ ·çš„ã€‚æ‰€ä»¥è¿™é‡Œçš„`<transition-group :name="dest" tag="ul" class="img">`çš„ name çš„å€¼æ˜¯åŠ¨æ€ç»‘å®šçš„ã€‚å½“å‘ä»€ä¹ˆæ–¹å‘ç§»åŠ¨æ—¶ï¼Œå°±åº”ç”¨ä»€ä¹ˆæ–¹å‘çš„ cssã€‚

ä¸Šè¿°å·¦å³æŒ‰é’®çš„ç‚¹å‡»å’Œå°åœ†ç‚¹çš„ç‚¹å‡»äº‹ä»¶é‡Œå‡æœ‰ä¿®æ”¹å¯¹åº”æ–¹å‘çš„å€¼ã€‚

```js
  data() {
    return {
      dest: 'img-next',
    }
```

### è‡ªåŠ¨æ’­æ”¾

å›¾ç‰‡è‡ªåŠ¨æ»šåŠ¨ä¸æ˜¯ä»€ä¹ˆå¤æ‚çš„äº‹æƒ…ï¼Œè®¾ç½®ä¸€ä¸ªå®šæ—¶å™¨å°±èƒ½è§£å†³ã€‚

```js
    autoPlay() {
      this.dest = 'img-next';
      this.timer = setInterval(() => {
        this.show == 4 ? (this.show = 0) : this.show++;
      }, 3000);
    },
```

æ­¤å¤–åœ¨ç»‘å®šä¸¤ä¸ªé¼ æ ‡ç§»å…¥å’Œç§»é™¤çš„äº‹ä»¶ï¼Œç”¨æ¥è®¾ç½®æš‚åœå’Œç»§ç»­æ’­æ”¾ã€‚

```html
@mouseover="pausePlay" @mouseout="continuePlay"
```

```js
    pausePlay() {
      clearInterval(this.timer);
    },
    continuePlay() {
      this.autoPlay();
    }
```

## ğŸ‰

è¿™é‡Œçš„ Vue å®ç°æ–¹æ¡ˆä¸»è¦æ˜¯ç”¨äº PC ç«¯çš„ï¼Œå®ƒå¯ä»¥åˆ©ç”¨ Vue çš„ `transition-group`æ¥è¿‡æ¸¡åˆ‡æ¢çš„å›¾ç‰‡ï¼Œè½»æ¾å®ç°æ— é™å¾ªç¯ã€‚

ä½†è¿™ä¸ªæ–¹æ¡ˆçš„ä¸€ä¸ªç¼ºç‚¹å°±æ˜¯å¯¹äºè§¦å±çš„ç§»åŠ¨ç«¯ä¸æ˜¯å¾ˆå‹å¥½ï¼Œå•é `transition-group`æ¥ç»™æ»‘åŠ¨æ—¶æ˜¾ç¤ºå›¾ç‰‡ä¼šæ¯”è¾ƒå¤æ‚ã€‚æ›´ä½³çš„å®ç°æ–¹æ¡ˆè¿˜æ˜¯å°†ä¸Šè¿°ä¼ ç»Ÿçš„å®ç°æ–¹å¼å°è£…æˆä¸€ä¸ªç»„ä»¶ï¼Œåç»­å†è€ƒè™‘å®ç°ä¸€ä¸‹ã€‚